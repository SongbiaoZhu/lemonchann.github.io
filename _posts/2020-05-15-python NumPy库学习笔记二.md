---
layout: post
title: "python NumPy库学习笔记二"
date:   2020-05-15
tags: [python]
toc: true
comments: true
author: Songbiao Zhu
---

Numpy 库学习笔记，第二部分。
## 引言

继续学习numpy库。

主要内容为NumPy 切片和索引。

## NumPy 切片和索引 

ndarray对象的内容可以通过索引或切片来访问和修改，与 Python 中 list 的切片操作一样。

ndarray 数组可以基于 0 - n 的下标进行索引，切片对象可以通过内置的 slice 函数，并设置 start, stop 及 step 参数进行，从原数组中切割出一个新数组。

### 通过slice()函数进行切片

slice()函数是内置的函数，**slice()** 函数实现切片对象，主要用在切片操作函数里的参数传递。

```python
import numpy as np
a = np.arange(10)
s = slice(2,7,2)

print(a)
[0 1 2 3 4 5 6 7 8 9]

print(a[s])
[2 4 6]
```

### 通过冒号`:` 以及`...`进行切片

也可以通过冒号分隔切片参数 **start:stop:step** 来进行切片操作：

```python
import numpy as np
 
a = np.arange(10)  
b = a[2:7:2]   # 从索引 2 开始到索引 7 停止，间隔为 2
print(b)
# out [2  4  6]
```

冒号 : 的解释：如果只放置一个参数，如 **[2]**，将返回与该索引相对应的单个元素。如果为 **[2:]**，表示从该索引开始以后的所有项都将被提取。如果使用了两个参数，如 **[2:7]**，那么则提取两个索引(不包括停止索引)之间的项。

```python
a = np.arange(10)  # [0 1 2 3 4 5 6 7 8 9]

b = a[5]

print(b)
5

print(a[2:])
[2 3 4 5 6 7 8 9]

print(a[2:5])
[2 3 4]
```

多维数组同样适用上述索引提取方法：

切片还可以包括省略号 …，来使选择元组的长度与数组的维度相同。 如果在行位置使用省略号，它将返回包含行中元素的 ndarray。

```python
a = np.array([[1,2,3],[3,4,5],[4,5,6]])

print(a[1:])
[[3 4 5]
 [4 5 6]]

print (a[...,1])   # 第2列元素
[2 4 5]

print (a[1,...])   # 第2行元素
[3 4 5]

print (a[...,1:])  # 第2列及剩下的所有元素
[[2 3]
 [4 5]
 [5 6]]
```

冒号切片的用法，有些类似与R语言中的数据框切片的用法。

## NumPy 高级索引

除了上述介绍的用整数和切片的索引外，数组可以由整数数组索引、布尔索引及花式索引。

### 整数数组索引 

使用整数数组进行索引一个已存在的数组，返回一个包含所取元素的 ndarray 对象。

```python
import numpy as np 
# 以下实例获取数组中(0,0)，(1,1)和(2,0)位置处的元素。
x = np.array([[1,  2],  [3,  4],  [5,  6]]) 
y = x[[0,1,2],  [0,1,0]]  
print (y)
Out[164]:[1 4 5]
type(y)
Out[165]: numpy.ndarray
    
# 以下实例获取数组4*3数组的四个角的元素。    
x = np.array([[  0,  1,  2],[  3,  4,  5],[  6,  7,  8],[  9,  10,  11]])
rows = np.array([[0,0],[3,3]]) 
cols = np.array([[0,2],[0,2]]) 
y = x[rows,cols]
print (y)
[[ 0  2]
 [ 9 11]]

type(y)
Out[169]: numpy.ndarray
type(rows)
Out[170]: numpy.ndarray

#结合: 和...进行索引
a = np.array([[1,2,3], [4,5,6],[7,8,9]])
b = a[1:3, 1:3]
c = a[1:3,[1,2]]
d = a[...,1:]
print(b)
print(c)
print(d)
```

### 布尔索引

布尔索引通过布尔运算（如：比较运算符）来获取符合指定条件的元素的数组。

```python
# 以下实例获取大于 5 的元素：
x = np.array([[  0,  1,  2],[  3,  4,  5],[  6,  7,  8],[  9,  10,  11]])  
print (x[x >  5])

# 以下实例使用了 ~（取补运算符）来过滤 NaN。
a = np.array([np.nan,  1,2,np.nan,3,4,5])  
print (a[~np.isnan(a)])

# 以下实例演示如何从数组中过滤掉非复数元素。
a = np.array([1,  2+6j,  5,  3.5+5j])  
print (a[np.iscomplex(a)])
```

### 花式索引

花式索引指的是利用整数数组进行索引。

花式索引根据索引数组的值作为目标数组的某个轴的下标来取值。对于使用一维整型数组作为索引，如果目标是一维数组，那么索引的结果就是对应位置的元素；如果目标是二维数组，那么就是对应下标的行。

花式索引跟切片不一样，它总是将数据复制到新数组中。

```python
x=np.arange(32).reshape((8,4))
print(x)
[[ 0  1  2  3]
 [ 4  5  6  7]
 [ 8  9 10 11]
 [12 13 14 15]
 [16 17 18 19]
 [20 21 22 23]
 [24 25 26 27]
 [28 29 30 31]]

# 1. 传入顺序索引数组，即取相应的行
print (x[[4,2,1,7]])
[[16 17 18 19]
 [ 8  9 10 11]
 [ 4  5  6  7]
 [28 29 30 31]]

# 2. 传入倒序索引数组，即倒着数取相应的行
print (x[[-4,-2,-1,-7]])
[[16 17 18 19]
 [24 25 26 27]
 [28 29 30 31]
 [ 4  5  6  7]]

# 3. 传入多个索引数组（要使用np.ix_），即第一个数组是对应的行，第二个数组是对应的列
print (x[np.ix_([1,5,7,2],[0,3,1,2])])
[[ 4  7  5  6]
 [20 23 21 22]
 [28 31 29 30]
 [ 8 11  9 10]]
```

